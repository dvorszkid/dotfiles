#!/bin/bash
# A tool to simulate ALT+NUMPAD ascii code entering functionality for numbers 0-9
# created by d347h

## Required Programs
# xbindkeys
# xdotool

## Contents of .xbindkeysrc
# "~/bin/alt_ascii 0"
#     Alt + KP_Insert
# "~/bin/alt_ascii 1"
#     Alt + KP_End
# "~/bin/alt_ascii 2"
#     Alt + KP_Down
# "~/bin/alt_ascii 3"
#     Alt + KP_Next
# "~/bin/alt_ascii 4"
#     Alt + KP_Left
# "~/bin/alt_ascii 5"
#     Alt + KP_Begin
# "~/bin/alt_ascii 6"
#     Alt + KP_Right
# "~/bin/alt_ascii 7"
#     Alt + KP_Home
# "~/bin/alt_ascii 8"
#     Alt + KP_Up
# "~/bin/alt_ascii 9"
#     Alt + KP_Prior


# if we don't have a file, start at zero
if [[ ! -f "/tmp/alt_ascii_value.dat" ]]; then
    value="$1"
# otherwise read the value from the file
else
    value=`cat /tmp/alt_ascii_value.dat`
fi

# filter wrong starts
if [[ ${#value} = 1 ]]; then
    case "$value" in
	"4")
	;;
	"5")
	;;
	*)
	    value=""
	;;
    esac
fi

# increment the value
value="$value""$1"

# do action if length is correct
if [[ ${#value} -ge 2 ]]; then
    case "$value" in
	"48")
	    NUM="0"
	;;
	"49")
	    NUM="1"
	;;
	"50")
	    NUM="2"
	;;
	"51")
	    NUM="3"
	;;
	"52")
	    NUM="4"
	;;
	"53")
	    NUM="5"
	;;
	"54")
	    NUM="6"
	;;
	"55")
	    NUM="7"
	;;
	"56")
	    NUM="8"
	;;
	"57")
	    NUM="9"
	;;
	*)
	    NUM=""
	;;
    esac
    xdotool type --window `xdotool getwindowfocus` --clearmodifiers $NUM
    value=""
fi

# and save it for next time
echo "${value}" > /tmp/alt_ascii_value.dat
